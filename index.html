<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è´¦å·ç›‘æ§æ± </title>
    <style>
        /* ğŸ“± æ‰‹æœºç«¯ä¼˜å…ˆçš„æ ·å¼è®¾è®¡ */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f5f6f7;
            margin: 0;
            padding: 15px;
            color: #1f2329;
            -webkit-tap-highlight-color: transparent;
        }

        h2 {
            text-align: center;
            font-size: 18px;
            margin: 10px 0 20px 0;
            color: #000;
        }

        .refresh-tip {
            text-align: center;
            font-size: 12px;
            color: #8f959e;
            margin-bottom: 15px;
        }

        /* å¡ç‰‡å®¹å™¨ */
        .card {
            background: #fff;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            border: 1px solid #dee0e3;
        }

        /* å¤´éƒ¨ï¼šåœ°åŒº + çŠ¶æ€ */
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px dashed #eff0f1;
        }

        .region-badge {
            font-weight: 700;
            font-size: 16px;
            display: flex;
            align-items: center;
        }
        
        .region-badge::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 16px;
            background: #3370ff; /* é£ä¹¦è“ */
            margin-right: 8px;
            border-radius: 2px;
        }

        .status-badge {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 4px;
            background: #eafff2; /* æµ…ç»¿èƒŒæ™¯ */
            color: #00b656;      /* ç»¿è‰²æ–‡å­— */
        }

        /* è´¦å·å¯†ç è¡Œ */
        .row {
            margin-bottom: 12px;
        }
        
        .row:last-child {
            margin-bottom: 0;
        }

        .label {
            font-size: 12px;
            color: #8f959e;
            margin-bottom: 4px;
        }

        .value-box {
            display: flex;
            align-items: center;
            background: #f5f6f7;
            border-radius: 6px;
            padding: 10px;
            border: 1px solid #dee0e3;
            position: relative;
        }

        .value-text {
            flex: 1;
            font-family: "SF Mono", Consolas, monospace; /* ç­‰å®½å­—ä½“æ–¹ä¾¿çœ‹å¯†ç  */
            font-size: 14px;
            word-break: break-all;
            margin-right: 10px;
        }

        /* å¤åˆ¶æŒ‰é’® */
        .copy-btn {
            background: #3370ff;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 6px 12px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
        }

        .copy-btn:active {
            opacity: 0.8;
            transform: scale(0.95);
        }

        .copy-btn.copied {
            background: #00b656;
        }

        .footer {
            text-align: right;
            font-size: 11px;
            color: #bbbfc4;
            margin-top: 8px;
        }
    </style>
</head>
<body>

    <h2>âš¡ï¸ å®æ—¶è´¦å·æ± </h2>
    <div class="refresh-tip" id="status-tip">æ­£åœ¨è·å–æœ€æ–°æ•°æ®...</div>
    <div id="app"></div>

    <script>
        // ===========================================
        // ğŸ‘‡ğŸ‘‡ğŸ‘‡ è¯·å°†æ­¤å¤„ä¿®æ”¹ä¸ºæ‚¨çš„ GitHub ç”¨æˆ·å ğŸ‘‡ğŸ‘‡ğŸ‘‡
        // ===========================================
        const GITHUB_USERNAME = 'Chenghana';  // ä¾‹å¦‚ï¼šzhangsan
        const REPO_NAME = 'woko-monitor'; // å¦‚æœæ‚¨çš„ä»“åº“åæ”¹è¿‡ï¼Œè¯·ä¿®æ”¹è¿™é‡Œ
        // ===========================================

        // ä½¿ç”¨ CDN åŠ é€Ÿè¯»å–æ•°æ®
        const dataUrl = `./data.json?t=${new Date().getTime()}`;

        fetch(dataUrl)
            .then(res => {
                if (!res.ok) throw new Error("æ— æ³•è¿æ¥æ•°æ®æºï¼Œè¯·æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦æ­£ç¡®");
                return res.json();
            })
            .then(json => {
                const app = document.getElementById('app');
                const tip = document.getElementById('status-tip');
                
                if (!json.data || json.data.length === 0) {
                    app.innerHTML = '<div style="text-align:center;padding:20px;color:#999">æš‚æ— å¯ç”¨æ•°æ®</div>';
                    return;
                }

                // æ›´æ–°çŠ¶æ€æç¤º
                const updateTime = json.updated_at ? new Date(json.updated_at).toLocaleString() : 'åˆšåˆš';
                tip.innerHTML = `æœ€åæ›´æ–°: ${updateTime} Â· å…± ${json.data.length} ä¸ªè´¦å·`;

                // æ¸²æŸ“å¡ç‰‡
                let html = '';
                json.data.forEach((item, index) => {
                    html += `
                        <div class="card">
                            <div class="card-header">
                                <div class="region-badge">${item.region || 'æœªçŸ¥åŒºåŸŸ'}</div>
                                <div class="status-badge">â— ${item.status}</div>
                            </div>
                            
                            <div class="row">
                                <div class="label">è´¦å·</div>
                                <div class="value-box">
                                    <div class="value-text">${item.username}</div>
                                    <button class="copy-btn" onclick="copyText(this, '${item.username}')">å¤åˆ¶</button>
                                </div>
                            </div>

                            <div class="row">
                                <div class="label">å¯†ç </div>
                                <div class="value-box">
                                    <div class="value-text">${item.password}</div>
                                    <button class="copy-btn" onclick="copyText(this, '${item.password}')">å¤åˆ¶</button>
                                </div>
                            </div>
                            
                            <div class="footer">Check: ${item.checkTime ? item.checkTime.split(' ')[1] : ''}</div>
                        </div>
                    `;
                });
                app.innerHTML = html;
            })
            .catch(err => {
                document.getElementById('status-tip').innerHTML = `<span style="color:red">åŠ è½½å¤±è´¥: ${err.message}</span>`;
            });

        // å¤åˆ¶åŠŸèƒ½æ ¸å¿ƒä»£ç 
        function copyText(btn, text) {
            // æ‰‹æœºç«¯å…¼å®¹æ€§æœ€å¥½çš„å¤åˆ¶æ–¹æ³•
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed'; // é˜²æ­¢é¡µé¢æ»šåŠ¨
            textarea.style.opacity = '0';
            document.body.appendChild(textarea);
            textarea.select();
            
            try {
                document.execCommand('copy');
                // è§†è§‰åé¦ˆ
                const originalText = btn.innerText;
                btn.innerText = 'æˆåŠŸ';
                btn.classList.add('copied');
                
                setTimeout(() => {
                    btn.innerText = originalText;
                    btn.classList.remove('copied');
                }, 1500);
            } catch (err) {
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é•¿æŒ‰å¤åˆ¶');
            }
            
            document.body.removeChild(textarea);
        }
    </script>
</body>
</html>
