<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Appleidåˆ†äº«</title>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <style>
        /* ğŸ“± åŸºç¡€æ ·å¼ */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f5f6f7;
            margin: 0;
            padding: 15px;
            color: #1f2329;
            -webkit-tap-highlight-color: transparent;
        }

        h2 { text-align: center; font-size: 18px; margin: 10px 0 5px 0; color: #000; }
        
        .visitor-count {
            text-align: center;
            font-size: 12px;
            color: #646a73;
            margin-bottom: 5px;
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        .visitor-count span { font-family: monospace; font-weight: bold; color: #3370ff; }
        
        /* ğŸ‘‡ğŸ‘‡ğŸ‘‡ æ–°å¢ï¼šå€’è®¡æ—¶æç¤ºæ¡æ ·å¼ ğŸ‘‡ğŸ‘‡ğŸ‘‡ */
        .lock-tip { 
            text-align: center; 
            font-size: 12px; 
            color: #d0021b; /* çº¢è‰² */
            margin-bottom: 15px;
            background: #fff0f0;
            padding: 8px;
            border-radius: 6px;
            border: 1px solid #ffdbdb;
            display: none; /* é»˜è®¤éšè— */
        }

        .tutorial-section {
            background: #fff;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            border: 1px solid #dee0e3;
        }
        
        .tutorial-title {
            font-weight: bold;
            color: #d0021b;
            margin-bottom: 10px;
            font-size: 15px;
            text-align: center;
        }

        .image-row {
            display: flex;            
            justify-content: center;  
            align-items: center;      
            gap: 10px;                
        }

        .side-by-side-img {
            width: 48%;               
            height: auto;             
            border-radius: 6px;
            border: 1px solid #eee;
            cursor: zoom-in;          
            object-fit: cover;        
        }

        .image-modal { display: none; position: fixed; z-index: 9999; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.9); align-items: center; justify-content: center; animation: fadeIn 0.2s; }
        .modal-content { margin: auto; display: block; max-width: 95%; max-height: 95%; border-radius: 5px; }
        .modal-tip { position: absolute; bottom: 20px; color: #fff; font-size: 14px; background: rgba(255,255,255,0.2); padding: 5px 15px; border-radius: 20px; }
        @keyframes fadeIn { from {opacity: 0} to {opacity: 1} }

        .card { background: #fff; border-radius: 12px; padding: 16px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04); border: 1px solid #dee0e3; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px dashed #eff0f1; }
        .region-badge { font-weight: 700; font-size: 16px; display: flex; align-items: center; }
        .region-badge::before { content: ''; display: inline-block; width: 4px; height: 16px; background: #3370ff; margin-right: 8px; border-radius: 2px; }
        .status-badge { font-size: 12px; padding: 2px 8px; border-radius: 4px; background: #eafff2; color: #00b656; }
        .row { margin-bottom: 12px; }
        .row:last-child { margin-bottom: 0; }
        .label { font-size: 12px; color: #8f959e; margin-bottom: 4px; }
        .value-box { display: flex; align-items: center; background: #f5f6f7; border-radius: 6px; padding: 10px; border: 1px solid #dee0e3; position: relative; }
        .value-text { flex: 1; font-family: "SF Mono", Consolas, monospace; font-size: 14px; word-break: break-all; margin-right: 10px; }
        .copy-btn { background: #3370ff; color: white; border: none; border-radius: 4px; padding: 6px 12px; font-size: 12px; font-weight: 600; cursor: pointer; white-space: nowrap; }
        .copy-btn:active { opacity: 0.8; transform: scale(0.95); }
        .copy-btn.copied { background: #00b656; }
        .footer { text-align: right; font-size: 11px; color: #bbbfc4; margin-top: 8px; }
    </style>
</head>
<body>

    <h2>æ°¸ä¹…ç‹¬äº«åŠ  han91918888</h2>
    
    <div class="visitor-count">
        <span id="busuanzi_container_site_uv" style="display:none">ğŸ‘¤ è®¿å®¢: <span id="busuanzi_value_site_uv">--</span></span>
        <span id="busuanzi_container_site_pv" style="display:none">ğŸ‘ï¸ æµè§ˆ: <span id="busuanzi_value_site_pv">--</span></span>
    </div>

    <div class="lock-tip" id="lock-tip"></div>
    <div class="refresh-tip" id="status-tip" style="display:none">æ­£åœ¨è·å–æœ€æ–°æ•°æ®...</div>

    <div class="tutorial-section">
        <div class="tutorial-title">âš ï¸ ä½¿ç”¨å‰å¿…çœ‹ (ç‚¹å‡»å›¾ç‰‡æ”¾å¤§)</div>
        <div class="image-row">
            <img src="./warning.png" class="side-by-side-img" onclick="openModal(this)" alt="è­¦å‘Š">
            <img src="./guide.jpg" class="side-by-side-img" onclick="openModal(this)" alt="æ•™ç¨‹">
        </div>
    </div>

    <div id="app"></div>

    <div id="imageModal" class="image-modal" onclick="closeModal()">
        <img class="modal-content" id="modalImg">
        <div class="modal-tip">ç‚¹å‡»ä»»æ„å¤„å…³é—­</div>
    </div>

    <script>
        // ===========================================
        // ğŸ‘‡ğŸ‘‡ğŸ‘‡ é…ç½®åŒºåŸŸ ğŸ‘‡ğŸ‘‡ğŸ‘‡
        const LOCK_HOURS = 12; // é”å®šæ—¶é—´ï¼š12å°æ—¶
        const CACHE_KEY = 'woko_data_cache_v1'; // ç¼“å­˜çš„é’¥åŒ™åç§°
        // ===========================================

        const dataUrl = `./data.json?t=${new Date().getTime()}`;

        // ğŸš€ æ ¸å¿ƒé€»è¾‘ï¼šæ™ºèƒ½åŠ è½½æ•°æ®
        initData();

        function initData() {
            const app = document.getElementById('app');
            const lockTip = document.getElementById('lock-tip');
            const statusTip = document.getElementById('status-tip');
            
            // 1. æ£€æŸ¥æ˜¯å¦æœ‰æœ¬åœ°ç¼“å­˜
            const cachedString = localStorage.getItem(CACHE_KEY);
            
            if (cachedString) {
                const cached = JSON.parse(cachedString);
                const now = new Date().getTime();
                const diff = now - cached.timestamp;
                const lockTime = LOCK_HOURS * 60 * 60 * 1000;

                // 2. å¦‚æœç¼“å­˜è¿˜æ²¡è¿‡æœŸ (å°äº12å°æ—¶)
                if (diff < lockTime) {
                    console.log("ğŸ”’ å‘½ä¸­ç¼“å­˜ï¼Œä½¿ç”¨æœ¬åœ°æ•°æ®ï¼Œä¸æ¶ˆè€—æµé‡");
                    renderCards(cached.data);
                    
                    // è®¡ç®—å‰©ä½™æ—¶é—´
                    const remaining = lockTime - diff;
                    const hours = Math.floor((remaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
                    
                    lockTip.style.display = 'block';
                    lockTip.innerHTML = `ğŸ”’ æ•°æ®å·²é”å®š (é˜²åˆ·æœºåˆ¶)<br>ä¸‹æ¬¡æ›´æ–°ï¼š${hours}å°æ—¶${minutes}åˆ†å`;
                    return; // âŒ ç›´æ¥ç»“æŸï¼Œä¸è¯·æ±‚ç½‘ç»œ
                }
            }

            // 3. å¦‚æœæ²¡æœ‰ç¼“å­˜æˆ–å·²è¿‡æœŸ -> è¯·æ±‚ç½‘ç»œ
            console.log("ğŸŒ ç¼“å­˜è¿‡æœŸæˆ–ä¸å­˜åœ¨ï¼Œè¯·æ±‚æ–°æ•°æ®...");
            statusTip.style.display = 'block';
            
            fetch(dataUrl)
                .then(res => {
                    if (!res.ok) throw new Error("è¿æ¥æ•°æ®æºä¸­...");
                    return res.json();
                })
                .then(json => {
                    if (!json.data || json.data.length === 0) {
                        app.innerHTML = '<div style="text-align:center;padding:20px;color:#999">æš‚æ— å¯ç”¨æ•°æ®</div>';
                        return;
                    }

                    // 4. æ¸²æŸ“ç•Œé¢
                    renderCards(json.data);
                    statusTip.style.display = 'none';

                    // 5. ğŸ”¥ å†™å…¥ç¼“å­˜ (è®°ä¸‹å½“å‰æ—¶é—´)
                    const cacheData = {
                        timestamp: new Date().getTime(),
                        data: json.data
                    };
                    localStorage.setItem(CACHE_KEY, JSON.stringify(cacheData));
                    
                    // æ˜¾ç¤ºåˆšåˆšæ›´æ–°
                    lockTip.style.display = 'block';
                    lockTip.style.color = '#00b656';
                    lockTip.style.background = '#eafff2';
                    lockTip.style.borderColor = '#b7ebcd';
                    lockTip.innerHTML = `âœ… æ•°æ®å·²æ›´æ–°<br>ä¸‹æ¬¡åˆ·æ–°å°†é”å®š ${LOCK_HOURS} å°æ—¶`;
                })
                .catch(err => {
                    console.log("è¯»å–å¤±è´¥");
                    statusTip.innerHTML = "æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ";
                });
        }

        // æ¸²æŸ“å¡ç‰‡çš„å‡½æ•° (æå–å‡ºæ¥äº†)
        function renderCards(data) {
            const app = document.getElementById('app');
            let html = '';
            data.forEach((item) => {
                html += `
                    <div class="card">
                        <div class="card-header">
                            <div class="region-badge">${item.region || 'æœªçŸ¥åŒºåŸŸ'}</div>
                            <div class="status-badge">â— ${item.status}</div>
                        </div>
                        <div class="row">
                            <div class="label">è´¦å·</div>
                            <div class="value-box">
                                <div class="value-text">${item.username}</div>
                                <button class="copy-btn" onclick="copyText(this, '${item.username}')">å¤åˆ¶</button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="label">å¯†ç </div>
                            <div class="value-box">
                                <div class="value-text">${item.password}</div>
                                <button class="copy-btn" onclick="copyText(this, '${item.password}')">å¤åˆ¶</button>
                            </div>
                        </div>
                        <div class="footer">Check: ${item.checkTime ? item.checkTime.split(' ')[1] : ''}</div>
                    </div>
                `;
            });
            app.innerHTML = html;
        }

        function copyText(btn, text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed'; 
            textarea.style.opacity = '0';
            document.body.appendChild(textarea);
            textarea.select();
            try {
                document.execCommand('copy');
                const originalText = btn.innerText;
                btn.innerText = 'æˆåŠŸ';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.innerText = originalText;
                    btn.classList.remove('copied');
                }, 1500);
            } catch (err) { alert('å¤åˆ¶å¤±è´¥'); }
            document.body.removeChild(textarea);
        }

        function openModal(imgElement) {
            var modal = document.getElementById("imageModal");
            var modalImg = document.getElementById("modalImg");
            modal.style.display = "flex";
            modalImg.src = imgElement.src;
        }

        function closeModal() {
            var modal = document.getElementById("imageModal");
            modal.style.display = "none";
        }
    </script>
</body>
</html>
